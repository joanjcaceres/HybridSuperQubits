(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     99982,       2944]
NotebookOptionsPosition[     91895,       2808]
NotebookOutlinePosition[     92453,       2829]
CellTagsIndexPosition[     92410,       2826]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"KineticTerm", " ", "=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], 
     SubscriptBox["C", "q"], " ", 
     SubsuperscriptBox[
      OverscriptBox["\[CapitalPhi]", "."], "Cq", "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], 
     SubscriptBox["C", "r"], 
     SubsuperscriptBox[
      OverscriptBox["\[CapitalPhi]", "."], "Cr", "2"]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9331453326011143`*^9, 3.933145358552952*^9}, {
  3.933145417846458*^9, 3.9331454393680763`*^9}, {3.933146631531212*^9, 
  3.933146657106785*^9}, {3.9423035334606256`*^9, 3.942303534933304*^9}, {
  3.942306396131817*^9, 3.9423064265743303`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"aae5bc2f-b6b1-4cd3-b3a2-2da94e516a5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PotentialTerm", " ", "=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", "*", 
       SubscriptBox["L", "q"]}]], 
     SuperscriptBox[
      SubscriptBox["\[CapitalPhi]", "Lq"], "2"]}], "+", " ", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", "*", 
       SubscriptBox["L", "c"]}]], " ", 
     SuperscriptBox[
      SubscriptBox["\[CapitalPhi]", "Lc"], "2"]}], "+", " ", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", "*", 
       SubscriptBox["L", "r"]}]], 
     SuperscriptBox[
      SubscriptBox["\[CapitalPhi]", "Lr"], "2"]}], "-", 
    RowBox[{"EJ", " ", "*", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"2", "*", "\[Pi]"}], 
        SubscriptBox["\[CapitalPhi]", "0"]], "*", " ", 
       SubscriptBox["\[CapitalPhi]", "Cq"]}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.933148431159616*^9, 3.933148467782692*^9}, 
   3.9331485354109583`*^9, 3.933148673727462*^9, 3.9423029833553467`*^9, {
   3.9423038505060987`*^9, 3.942303852709593*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"55d23824-75d2-43ef-94bd-92d55565b59b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Lagrangian", " ", "=", " ", 
   RowBox[{"KineticTerm", " ", "-", " ", "PotentialTerm"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.933145835439868*^9, 3.933145863946908*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"8e60f00c-926f-4a49-8e4e-e3554e78a337"],

Cell["Kirchhoff' s Law :", "Text",
 CellChangeTimes->{{3.9331459888312817`*^9, 3.933146006217411*^9}, 
   3.93314817496863*^9},ExpressionUUID->"298a73bc-5e75-44c1-9fea-\
fb93768a2a86"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"loop1", " ", "=", " ", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalPhi]", "Ej"], "+", "  ", 
     SubscriptBox["\[CapitalPhi]", "Cq"]}], "==", " ", "0"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"loop2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalPhi]", "Lq"], " ", "-", " ", 
     SubscriptBox["\[CapitalPhi]", "Lc"], " ", "-", "  ", 
     SubscriptBox["\[CapitalPhi]", "Ej"]}], " ", "==", " ", 
    SubscriptBox["\[CapitalPhi]", "ext"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"loop3", " ", "=", " ", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalPhi]", "Lc"], "+", 
     SubscriptBox["\[CapitalPhi]", "Lr"], " ", "-", 
     SubscriptBox["\[CapitalPhi]", "Cr"]}], " ", "==", " ", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KirchhoffSystem", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"loop1", ",", "loop2", ",", "loop3"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9331460228619556`*^9, 3.9331460986907587`*^9}, {
   3.933146153343704*^9, 3.933146155585758*^9}, {3.933146298952524*^9, 
   3.933146318086437*^9}, {3.93314658753763*^9, 3.9331466155438013`*^9}, {
   3.933148122882761*^9, 3.9331481247210817`*^9}, {3.933148176580731*^9, 
   3.933148228145649*^9}, 3.933156782946258*^9, 3.93315690680025*^9, {
   3.942223834595392*^9, 3.942223908610002*^9}, 3.942302971030219*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"97ebba7c-fded-4ca8-8823-fa13e6885cb1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{"KirchhoffSystem", ",", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Lr"], " ", ",", 
      SubscriptBox["\[CapitalPhi]", "Lc"], " ", ",", 
      SubscriptBox["\[CapitalPhi]", "Ej"]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.933148110880726*^9, 3.933148113312554*^9}, {
   3.933148233655962*^9, 3.933148289321476*^9}, 3.933148555011408*^9, {
   3.933148610829623*^9, 3.933148656046545*^9}, 3.9331493411934566`*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"8aa8dbc7-7563-48e2-bb78-a0e6eca4bda4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalPhi]", "Lr"], "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["\[CapitalPhi]", "Cq"]}], "+", 
      SubscriptBox["\[CapitalPhi]", "Cr"], "+", 
      SubscriptBox["\[CapitalPhi]", "ext"], "-", 
      SubscriptBox["\[CapitalPhi]", "Lq"]}]}], ",", 
    RowBox[{
     SubscriptBox["\[CapitalPhi]", "Lc"], "\[Rule]", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cq"], "-", 
      SubscriptBox["\[CapitalPhi]", "ext"], "+", 
      SubscriptBox["\[CapitalPhi]", "Lq"]}]}], ",", 
    RowBox[{
     SubscriptBox["\[CapitalPhi]", "Ej"], "\[Rule]", 
     RowBox[{"-", 
      SubscriptBox["\[CapitalPhi]", "Cq"]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.933149341449054*^9, 3.933149608779973*^9, 
  3.93315678591267*^9, 3.9331568623227882`*^9, 3.933156927376498*^9, 
  3.9422207117704353`*^9, 3.942223914192198*^9, 3.942297688216661*^9, 
  3.942302974606208*^9, 3.942303857531085*^9, 3.9423060168872004`*^9, 
  3.9423060649889193`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"e032ffcd-1b74-41cd-82a6-2e085ce1d429"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReplacePotentialTerm", " ", "=", " ", 
  RowBox[{"PotentialTerm", "/.", 
   RowBox[{"solution", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9331485838654327`*^9, 3.933148602816753*^9}, 
   3.933156853080071*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"6c0d5732-513e-48e1-90e7-61b6ea2c4ac4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "EJ"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]", " ", 
      SubscriptBox["\[CapitalPhi]", "Cq"]}], 
     SubscriptBox["\[CapitalPhi]", "0"]], "]"}]}], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["\[CapitalPhi]", "Cq"]}], "+", 
      SubscriptBox["\[CapitalPhi]", "Cr"], "+", 
      SubscriptBox["\[CapitalPhi]", "ext"], "-", 
      SubscriptBox["\[CapitalPhi]", "Lq"]}], ")"}], "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["L", "r"]}]], "+", 
  FractionBox[
   SubsuperscriptBox["\[CapitalPhi]", "Lq", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["L", "q"]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cq"], "-", 
      SubscriptBox["\[CapitalPhi]", "ext"], "+", 
      SubscriptBox["\[CapitalPhi]", "Lq"]}], ")"}], "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["L", "c"]}]]}]], "Output",
 CellChangeTimes->{
  3.933148603252021*^9, 3.933148661202855*^9, 3.9331486948761873`*^9, 
   3.9331496121797113`*^9, 3.9331567885369377`*^9, {3.9331568533652763`*^9, 
   3.9331568643343363`*^9}, 3.933156927378829*^9, 3.942220716323701*^9, 
   3.942224026781767*^9, 3.942297688254572*^9, 3.942302986731182*^9, 
   3.942303860656616*^9, 3.9423060184264393`*^9, 3.942306064992073*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"7bf4aa8c-f5a6-4f7c-85e3-4d54e52ba4ac"]
}, Open  ]],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   SubscriptBox["\[CapitalPhi]", "Lq"], " "}]],
  CellChangeTimes->{{3.9331460228619556`*^9, 3.9331460986907587`*^9}, {
   3.933146153343704*^9, 3.933146155585758*^9}, {3.933146298952524*^9, 
   3.933146318086437*^9}, {3.93314658753763*^9, 3.9331466155438013`*^9}, {
   3.933148122882761*^9, 3.9331481247210817`*^9}, {3.933148176580731*^9, 
   3.933148228145649*^9}},ExpressionUUID->
  "a5583dc7-73a2-41ae-8aa9-36b900002ac1"],
 " is a frozen variable, so by the Euler-Lagrange equation:"
}], "Text",
 CellChangeTimes->{{3.9331487924107637`*^9, 3.9331488087749767`*^9}, 
   3.933148875126553*^9, {3.942302995100017*^9, 
   3.942302995610612*^9}},ExpressionUUID->"afdcebd8-7ff4-4e18-b625-\
8a62b52a92f6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"frozenEquation", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"ReplacePotentialTerm", ",", 
        SubscriptBox["\[CapitalPhi]", "Lq"]}], " ", "]"}], "==", "0"}], ",", 
     SubscriptBox["\[CapitalPhi]", "Lq"]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.933148815475045*^9, 3.933148816403679*^9}, {
   3.933148863651394*^9, 3.9331489331021137`*^9}, {3.933149045690381*^9, 
   3.9331490517075167`*^9}, 3.933150925129221*^9, {3.933156800395105*^9, 
   3.93315680341485*^9}, {3.9422207225790243`*^9, 3.942220745877812*^9}, {
   3.942303878636005*^9, 3.9423038793619328`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"08bcf159-9c9a-435b-a9ec-5c71720a6924"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[CapitalPhi]", "Lq"], "\[Rule]", 
    FractionBox[
     RowBox[{
      SubscriptBox["L", "q"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["L", "r"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["\[CapitalPhi]", "Cq"]}], "+", 
           SubscriptBox["\[CapitalPhi]", "ext"]}], ")"}]}], "+", 
        RowBox[{
         SubscriptBox["L", "c"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["\[CapitalPhi]", "Cq"]}], "+", 
           SubscriptBox["\[CapitalPhi]", "Cr"], "+", 
           SubscriptBox["\[CapitalPhi]", "ext"]}], ")"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SubscriptBox["L", "q"], " ", 
       SubscriptBox["L", "r"]}], "+", 
      RowBox[{
       SubscriptBox["L", "c"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "q"], "+", 
         SubscriptBox["L", "r"]}], ")"}]}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.942220722825042*^9, 3.942220746252926*^9}, 
   3.9422242573494997`*^9, 3.9422976882934647`*^9, 3.94230299845251*^9, {
   3.942303864426981*^9, 3.9423038801022263`*^9}, 3.9423060200116663`*^9, 
   3.942306065013089*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"a7ad6212-7778-461f-8146-3aa2549d9930"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandedPotential", " ", "=", " ", 
   RowBox[{"Expand", "[", 
    RowBox[{"ReplacePotentialTerm", "/.", 
     RowBox[{"frozenEquation", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.933148948106907*^9, 3.9331490329365387`*^9}, {
   3.933149408088332*^9, 3.933149420283265*^9}, {3.93314946454871*^9, 
   3.9331494902343807`*^9}, {3.942220769793025*^9, 3.942220772867546*^9}, 
   3.9423038830732718`*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"16f476cb-d765-431d-89ab-11db8d5c2a88"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CollectedPotential", " ", "=", " ", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"ExpandedPotential", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       SubsuperscriptBox["\[CapitalPhi]", "Cq", "2"], ",", 
       RowBox[{
        SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
        SubscriptBox["\[CapitalPhi]", "Cr"]}], ",", " ", 
       SubsuperscriptBox["\[CapitalPhi]", "Cr", "2"], ",", 
       SubsuperscriptBox["\[CapitalPhi]", "ext", "2"], ",", 
       RowBox[{
        SubscriptBox["\[CapitalPhi]", "Cr"], " ", 
        SubscriptBox["\[CapitalPhi]", "ext"]}], ",", " ", 
       RowBox[{
        SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
        SubscriptBox["\[CapitalPhi]", "ext"]}]}], "}"}], ",", " ", 
     "FullSimplify"}], "]"}], "/.", 
   RowBox[{
    SubsuperscriptBox["\[CapitalPhi]", "ext", "2"], "->", "0"}]}]}]], "Input",\

 CellChangeTimes->{{3.933142201978578*^9, 3.933142216220908*^9}, {
   3.9331422464856853`*^9, 3.9331423143572073`*^9}, {3.933142407386674*^9, 
   3.933142452309363*^9}, {3.933142537937257*^9, 3.933142550728965*^9}, 
   3.93314298646832*^9, {3.9331432061950903`*^9, 3.933143212694962*^9}, {
   3.9331435888133593`*^9, 3.933143591904208*^9}, {3.933146469989893*^9, 
   3.9331465205984573`*^9}, {3.933146571088591*^9, 3.9331465765558453`*^9}, {
   3.9331466752770977`*^9, 3.933146688775333*^9}, {3.9331467260500402`*^9, 
   3.9331467577423058`*^9}, {3.933147100814292*^9, 3.933147101449325*^9}, 
   3.9331475908192673`*^9, {3.933148515373169*^9, 3.933148518782003*^9}, {
   3.9331490653287153`*^9, 3.933149071572785*^9}, {3.933149106253923*^9, 
   3.933149109478558*^9}, {3.933149446076991*^9, 3.933149449298429*^9}, {
   3.942303033097344*^9, 3.9423030352798433`*^9}, {3.942303895195499*^9, 
   3.942303896479512*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"7bce6afa-7f96-4ae5-8508-47546c1dd8b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "EJ"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]", " ", 
      SubscriptBox["\[CapitalPhi]", "Cq"]}], 
     SubscriptBox["\[CapitalPhi]", "0"]], "]"}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["L", "c"], "+", 
      SubscriptBox["L", "r"]}], ")"}], " ", 
    SubsuperscriptBox["\[CapitalPhi]", "Cq", "2"]}], 
   RowBox[{
    RowBox[{"2", " ", 
     SubscriptBox["L", "q"], " ", 
     SubscriptBox["L", "r"]}], "+", 
    RowBox[{"2", " ", 
     SubscriptBox["L", "c"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       SubscriptBox["L", "r"]}], ")"}]}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cr"]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "q"], " ", 
     SubscriptBox["L", "r"]}], "+", 
    RowBox[{
     SubscriptBox["L", "c"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       SubscriptBox["L", "r"]}], ")"}]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["L", "c"], "+", 
      SubscriptBox["L", "q"]}], ")"}], " ", 
    SubsuperscriptBox["\[CapitalPhi]", "Cr", "2"]}], 
   RowBox[{
    RowBox[{"2", " ", 
     SubscriptBox["L", "q"], " ", 
     SubscriptBox["L", "r"]}], "+", 
    RowBox[{"2", " ", 
     SubscriptBox["L", "c"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       SubscriptBox["L", "r"]}], ")"}]}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["L", "c"], "+", 
      SubscriptBox["L", "r"]}], ")"}], " ", 
    SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
    SubscriptBox["\[CapitalPhi]", "ext"]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "q"], " ", 
     SubscriptBox["L", "r"]}], "+", 
    RowBox[{
     SubscriptBox["L", "c"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       SubscriptBox["L", "r"]}], ")"}]}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cr"], " ", 
    SubscriptBox["\[CapitalPhi]", "ext"]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "q"], " ", 
     SubscriptBox["L", "r"]}], "+", 
    RowBox[{
     SubscriptBox["L", "c"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       SubscriptBox["L", "r"]}], ")"}]}]}]]}]], "Output",
 CellChangeTimes->{
  3.933142216651835*^9, {3.9331422718521433`*^9, 3.9331422824748917`*^9}, 
   3.933142314777657*^9, {3.933142419510491*^9, 3.933142470523785*^9}, {
   3.9331425394455347`*^9, 3.933142551141472*^9}, {3.933142973500382*^9, 
   3.933142986790718*^9}, 3.933143213104957*^9, 3.933143592275872*^9, 
   3.9331450116823587`*^9, 3.933146457360466*^9, {3.933146495461618*^9, 
   3.9331465305497637`*^9}, {3.933146572215201*^9, 3.9331465771730967`*^9}, {
   3.9331466763273363`*^9, 3.9331466892624197`*^9}, {3.933146726856948*^9, 
   3.933146762034486*^9}, 3.93314710215313*^9, 3.9331475914612513`*^9, 
   3.933148485765253*^9, {3.9331485157872543`*^9, 3.9331485194432793`*^9}, {
   3.933149058619597*^9, 3.933149073023855*^9}, {3.933149120252029*^9, 
   3.933149126020047*^9}, {3.933149422710429*^9, 3.9331494550807457`*^9}, 
   3.933149492510689*^9, 3.933149618195122*^9, 3.9331504851505337`*^9, 
   3.9331568095886917`*^9, 3.933156868988976*^9, 3.933156927496169*^9, 
   3.94222077918565*^9, 3.942224263115192*^9, 3.9422976918837957`*^9, {
   3.942303010371068*^9, 3.942303035730101*^9}, {3.942303888028249*^9, 
   3.9423038967248507`*^9}, 3.942305299381192*^9, 3.942306022274143*^9, 
   3.942306065033084*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"0fc27aeb-10f1-4ed1-8100-b6e688327472"]
}, Open  ]],

Cell[TextData[{
 "Factorizing ",
 Cell[BoxData[
  SubscriptBox["\[CapitalPhi]", 
   RowBox[{"C", " ", "q"}]]],
  CellChangeTimes->{
   3.933143927772917*^9, {3.93314417224177*^9, 3.933144206885355*^9}},
  ExpressionUUID->"a0d12b5d-57be-4ff3-b7d7-8f8f4a117fb3"],
 " forming a binomio with  ",
 Cell[BoxData[
  SubscriptBox["\[CapitalPhi]", "ext"]],
  CellChangeTimes->{
   3.933143927772917*^9, {3.93314417224177*^9, 3.933144206885355*^9}, {
    3.933144452907914*^9, 3.933144455510585*^9}, {3.933146783052341*^9, 
    3.933146914296533*^9}, {3.933147126992105*^9, 3.933147131539208*^9}, 
    3.933147164437653*^9, {3.933149134960125*^9, 3.9331491784488907`*^9}, {
    3.933149498565762*^9, 3.9331495892506113`*^9}, {3.9331504966280937`*^9, 
    3.9331505244190083`*^9}},ExpressionUUID->
  "e4f3f134-f82d-4f03-8cd7-d0fe32ead3fa"]
}], "Text",
 CellChangeTimes->{{3.93314442325891*^9, 3.933144441179984*^9}, {
  3.933150691734414*^9, 
  3.933150700253093*^9}},ExpressionUUID->"1774e2c0-7453-48e4-a193-\
e0186285ae43"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", 
     StyleBox[
      FractionBox[
       StyleBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["L", "q"], " ", 
           SubscriptBox["L", "r"]}], "+", 
          RowBox[{
           SubscriptBox["L", "c"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["L", "q"], "+", 
             SubscriptBox["L", "r"]}], ")"}]}]}], ")"}], "Code"], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "c"], "+", 
         SubscriptBox["L", "r"]}], ")"}]], "Code"]}]], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cq"], "-", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["L", "c"], "+", 
             SubscriptBox["L", "r"]}], ")"}], " "}], 
          RowBox[{
           RowBox[{
            SubscriptBox["L", "q"], " ", 
            SubscriptBox["L", "r"]}], "+", 
           RowBox[{
            SubscriptBox["L", "c"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["L", "q"], "+", 
              SubscriptBox["L", "r"]}], ")"}]}]}]], "/", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["L", "c"], "+", 
              SubscriptBox["L", "r"]}], ")"}], " "}], 
           RowBox[{
            RowBox[{"2", " ", 
             SubscriptBox["L", "q"], " ", 
             SubscriptBox["L", "r"]}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["L", "c"], " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["L", "q"], "+", 
               SubscriptBox["L", "r"]}], ")"}]}]}]], ")"}]}], "/", "2"}], " ",
        "*", 
       SubscriptBox["\[CapitalPhi]", "ext"]}]}], ")"}], "2"]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{
  3.933143927772917*^9, {3.93314417224177*^9, 3.933144206885355*^9}, {
   3.933144452907914*^9, 3.933144455510585*^9}, {3.933146783052341*^9, 
   3.933146914296533*^9}, {3.933147126992105*^9, 3.933147131539208*^9}, 
   3.933147164437653*^9, {3.933149134960125*^9, 3.9331491784488907`*^9}, {
   3.933149498565762*^9, 3.9331495892506113`*^9}, {3.9331504966280937`*^9, 
   3.9331505244190083`*^9}, {3.9422243442001877`*^9, 
   3.9422243576373377`*^9}, {3.94230393641923*^9, 3.9423039366286573`*^9}, {
   3.942303991283401*^9, 3.942304005797941*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"3f45b45f-daee-4339-b268-ef9dca8a42f4"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["L", "c"], "+", 
     SubscriptBox["L", "r"]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cq"], "-", 
      SubscriptBox["\[CapitalPhi]", "ext"]}], ")"}], "2"]}], 
  RowBox[{
   RowBox[{"2", " ", 
    SubscriptBox["L", "q"], " ", 
    SubscriptBox["L", "r"]}], "+", 
   RowBox[{"2", " ", 
    SubscriptBox["L", "c"], " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["L", "q"], "+", 
      SubscriptBox["L", "r"]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.933156927498929*^9, {3.942224353255402*^9, 3.942224358046023*^9}, 
   3.9422976938973637`*^9, 3.9423031255474253`*^9, 3.942303946162031*^9, 
   3.942304027615849*^9, 3.942306024155859*^9, 3.942306065040365*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"5527f0fe-eb07-478b-bcec-e96d09979643"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EffectiveLq", " ", "=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    FractionBox[
     RowBox[{" ", 
      RowBox[{
       RowBox[{
        SubscriptBox["L", "q"], " ", 
        SubscriptBox["L", "r"]}], "+", 
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["L", "q"], "+", 
          SubscriptBox["L", "r"]}], ")"}]}]}]}], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "c"], "+", 
       SubscriptBox["L", "r"]}], ")"}]], ",", 
    SubscriptBox["L", "q"]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.933147073459407*^9, 3.933147090612968*^9}, {
  3.93314719297602*^9, 3.933147224618413*^9}, {3.933149197261841*^9, 
  3.933149211593017*^9}, {3.933150548368672*^9, 3.93315055210413*^9}, {
  3.933150854970503*^9, 3.933150861591647*^9}, {3.942224383117588*^9, 
  3.942224416279336*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"b6f71678-df75-437f-b130-3c934dcb8e66"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["L", "q"], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["L", "r"]}], 
   RowBox[{
    SubscriptBox["L", "c"], "+", 
    SubscriptBox["L", "r"]}]]}]], "Output",
 CellChangeTimes->{3.933150862172961*^9, 3.933156927509616*^9, 
  3.942224417261759*^9, 3.942297695203361*^9, 3.942303954793508*^9, 
  3.942306025240986*^9, 3.942306065044262*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"f1c3ced8-f076-4169-9603-e86f48b40f49"]
}, Open  ]],

Cell[TextData[{
 "Factorizing ",
 Cell[BoxData[
  SubscriptBox["\[CapitalPhi]", 
   RowBox[{"C", " ", "r"}]]],
  CellChangeTimes->{
   3.933143927772917*^9, {3.93314417224177*^9, 3.933144206885355*^9}},
  ExpressionUUID->"c0880cfd-f1ed-416a-acb6-63e919ab4b53"],
 " forming a binomio with  ",
 Cell[BoxData[
  SubscriptBox["\[CapitalPhi]", "ext"]],
  CellChangeTimes->{
   3.933143927772917*^9, {3.93314417224177*^9, 3.933144206885355*^9}, {
    3.933144452907914*^9, 3.933144455510585*^9}, {3.933146783052341*^9, 
    3.933146914296533*^9}, {3.933147126992105*^9, 3.933147131539208*^9}, 
    3.933147164437653*^9, {3.933149134960125*^9, 3.9331491784488907`*^9}, {
    3.933149498565762*^9, 3.9331495892506113`*^9}, {3.9331504966280937`*^9, 
    3.9331505244190083`*^9}},ExpressionUUID->
  "ee4bc67a-4bcd-41a2-a154-116edfa695a2"]
}], "Text",
 CellChangeTimes->{{3.93314697078832*^9, 3.933146975811652*^9}, {
  3.933150704078795*^9, 
  3.933150705732688*^9}},ExpressionUUID->"fbcc1ea3-a22d-4780-ac0a-\
54005326de73"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "c"], "+", 
       SubscriptBox["L", "q"]}], ")"}], " "}], 
    RowBox[{
     RowBox[{"2", " ", 
      SubscriptBox["L", "q"], " ", 
      SubscriptBox["L", "r"]}], "+", 
     RowBox[{"2", " ", 
      SubscriptBox["L", "c"], " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["L", "q"], "+", 
        SubscriptBox["L", "r"]}], ")"}]}]}]], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cr"], "+", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox[
          SubscriptBox["L", "c"], 
          RowBox[{
           RowBox[{
            SubscriptBox["L", "q"], " ", 
            SubscriptBox["L", "r"]}], "+", 
           RowBox[{
            SubscriptBox["L", "c"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["L", "q"], "+", 
              SubscriptBox["L", "r"]}], ")"}]}]}]], "/", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["L", "c"], "+", 
             SubscriptBox["L", "q"]}], ")"}], " "}], 
          RowBox[{
           RowBox[{"2", " ", 
            SubscriptBox["L", "q"], " ", 
            SubscriptBox["L", "r"]}], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["L", "c"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["L", "q"], "+", 
              SubscriptBox["L", "r"]}], ")"}]}]}]]}], "/", "2"}], "*", 
       SubscriptBox["\[CapitalPhi]", "ext"]}]}], " ", ")"}], "2"]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.933145229754018*^9, 3.933145248808625*^9}, {
   3.933146985355301*^9, 3.933147030985313*^9}, {3.933147297999865*^9, 
   3.9331473630656557`*^9}, {3.9331492270943832`*^9, 
   3.9331492629432287`*^9}, {3.9331505632743607`*^9, 3.933150607781027*^9}, {
   3.942224427601619*^9, 3.942224510559054*^9}, {3.9423053267103577`*^9, 
   3.9423053575812197`*^9}, {3.942305395282634*^9, 3.942305414719075*^9}, 
   3.942305449295219*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"8859ba4d-88ca-47c7-a071-5cf8048480a3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox[
     SubscriptBox["L", "c"], 
     RowBox[{
      RowBox[{
       SubscriptBox["L", "q"], " ", 
       SubscriptBox["L", "r"]}], "+", 
      RowBox[{
       SubscriptBox["L", "c"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "q"], "+", 
         SubscriptBox["L", "r"]}], ")"}]}]}]], "/", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}], ")"}], " "}], 
     RowBox[{
      RowBox[{"2", " ", 
       SubscriptBox["L", "q"], " ", 
       SubscriptBox["L", "r"]}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["L", "c"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "q"], "+", 
         SubscriptBox["L", "r"]}], ")"}]}]}]]}], "/", "2"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.933145100408738*^9, 3.93314510161452*^9}, 
   3.9331470364173203`*^9, 3.933147369694223*^9, 3.933149269201538*^9, 
   3.9331506117492037`*^9, 3.942224530470847*^9, {3.942305431228259*^9, 
   3.9423054327419233`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"dd11621b-99a7-4285-9ffd-446c967d2e32"],

Cell[BoxData[
 FractionBox[
  SubscriptBox["L", "c"], 
  RowBox[{
   SubscriptBox["L", "c"], "+", 
   SubscriptBox["L", "q"]}]]], "Output",
 CellChangeTimes->{3.933147042524146*^9, 3.933147371184379*^9, 
  3.9331492703437443`*^9, 3.9331506132054577`*^9, 3.933156927522346*^9, 
  3.942224531449936*^9, 3.942297697945767*^9, 3.942303151494467*^9, 
  3.9423054332703648`*^9, 3.942306065052155*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"dd606af0-9b15-4b1d-a08e-45b0815f31d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EffectiveLr", " ", "=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["L", "q"], " ", 
        SubscriptBox["L", "r"]}], "+", " ", 
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["L", "q"], "+", 
          SubscriptBox["L", "r"]}], ")"}]}]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}], ")"}], " ", " "}]], ",", 
    SubscriptBox["L", "r"]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9331473785181913`*^9, 3.933147431945088*^9}, {
  3.933149284927699*^9, 3.9331492886974077`*^9}, {3.933150633715322*^9, 
  3.933150637250825*^9}, {3.9331508302498207`*^9, 3.933150870472357*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"c336ac93-ca00-41c8-962b-8e7d49cf0276"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["L", "q"]}], 
   RowBox[{
    SubscriptBox["L", "c"], "+", 
    SubscriptBox["L", "q"]}]], "+", 
  SubscriptBox["L", "r"]}]], "Output",
 CellChangeTimes->{3.933150870725848*^9, 3.93315692752452*^9, 
  3.942297700320998*^9, 3.942303158661014*^9, 3.942306029505183*^9, 
  3.9423060650579367`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"dfea3f4c-7245-438a-9592-b5a25aa9a4ed"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Coupling", " ", "=", " ", 
   FractionBox[
    RowBox[{
     SubscriptBox["L", "c"], " "}], 
    RowBox[{
     RowBox[{
      SubscriptBox["L", "q"], " ", 
      SubscriptBox["L", "r"]}], "+", 
     RowBox[{
      SubscriptBox["L", "c"], " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["L", "q"], "+", 
        SubscriptBox["L", "r"]}], ")"}]}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.933151511613844*^9, 3.933151520667218*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"6d5befa7-1792-4328-91fc-91ed32f6b7cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewPotential", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "EJ"}], " ", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]", " ", 
        SubscriptBox["\[CapitalPhi]", "Cq"]}], 
       SubscriptBox["\[CapitalPhi]", "0"]], "]"}]}], " ", "+", " ", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", "*", "EffectiveLq"}]], "*", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[CapitalPhi]", "Cq"], "-", 
        SubscriptBox["\[CapitalPhi]", "ext"]}], ")"}], "2"]}], " ", "+", " ", 
    
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", "*", "EffectiveLr"}]], "*", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[CapitalPhi]", "Cr"], "+", 
        RowBox[{
         FractionBox[
          SubscriptBox["L", "c"], 
          RowBox[{
           SubscriptBox["L", "c"], "+", 
           SubscriptBox["L", "q"]}]], 
         SubscriptBox["\[CapitalPhi]", "ext"]}]}], ")"}], "2"]}], "-", 
    RowBox[{"Coupling", " ", "*", " ", 
     SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
     SubscriptBox["\[CapitalPhi]", "Cr"]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9331475717172823`*^9, 3.9331476647394867`*^9}, {
   3.933147705339086*^9, 3.933147725894959*^9}, 3.933147768435145*^9, {
   3.9331506441097193`*^9, 3.933150645208325*^9}, {3.933150723650694*^9, 
   3.933150731369112*^9}, 3.933151196526409*^9, {3.933151528046556*^9, 
   3.933151532164344*^9}, 3.933151586096537*^9, {3.942305466253767*^9, 
   3.942305476049539*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"453e632f-d8db-4e9a-9c71-7dcb283a9825"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NewLagrangian", " ", "=", " ", 
  RowBox[{"KineticTerm", " ", "-", " ", "NewPotential"}]}]], "Input",
 CellChangeTimes->{{3.9423034070587463`*^9, 3.942303424216262*^9}, 
   3.942303660678431*^9, 3.9423037027977448`*^9},
 CellLabel->"In[58]:=",ExpressionUUID->"31cad483-734f-4f9f-b5e7-572a52b695d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EJ", " ", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]", " ", 
      SubscriptBox["\[CapitalPhi]", "Cq"]}], 
     SubscriptBox["\[CapitalPhi]", "0"]], "]"}]}], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cr"]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "q"], " ", 
     SubscriptBox["L", "r"]}], "+", 
    RowBox[{
     SubscriptBox["L", "c"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       SubscriptBox["L", "r"]}], ")"}]}]}]], "-", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cq"], "-", 
      SubscriptBox["\[CapitalPhi]", "ext"]}], ")"}], "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["L", "q"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "r"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "r"]}]]}], ")"}]}]], "-", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cr"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["\[CapitalPhi]", "ext"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}]]}], ")"}], "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "q"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}]], "+", 
      SubscriptBox["L", "r"]}], ")"}]}]], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SubscriptBox["C", "q"], " ", 
   SubsuperscriptBox[
    OverscriptBox["\[CapitalPhi]", "."], "Cq", "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SubscriptBox["C", "r"], " ", 
   SubsuperscriptBox[
    OverscriptBox["\[CapitalPhi]", "."], "Cr", "2"]}]}]], "Output",
 CellChangeTimes->{
  3.9423034253325577`*^9, 3.942303551580884*^9, {3.942303684304278*^9, 
   3.942303704482254*^9}, 3.942305502843157*^9, 3.942306033810809*^9, 
   3.942306065070806*^9, 3.942306384636807*^9, 3.942306430779106*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"a5e84a52-91d1-4c29-9f7d-2c5cbfc0023b"]
}, Open  ]],

Cell["To obtain the conjugate momentums:", "Text",
 CellChangeTimes->{{3.942297264925621*^9, 3.942297284804582*^9}, {
  3.9422981804586267`*^9, 3.942298192495576*^9}, {3.9422982826548557`*^9, 
  3.9422982997344933`*^9}, {3.942303235580991*^9, 3.942303306851223*^9}, {
  3.942305588166027*^9, 
  3.942305594231606*^9}},ExpressionUUID->"deb05919-6b90-4318-99d2-\
05300c703037"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"qp1", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["Q", "p"], "==", 
      RowBox[{"D", "[", 
       RowBox[{"NewLagrangian", ",", 
        SubscriptBox[
         OverscriptBox["\[CapitalPhi]", "."], "Cq"]}], "]"}]}], ",", 
     SubscriptBox[
      OverscriptBox["\[CapitalPhi]", "."], "Cq"]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qr1", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["Q", "r"], "==", 
      RowBox[{"D", "[", 
       RowBox[{"NewLagrangian", ",", 
        SubscriptBox[
         OverscriptBox["\[CapitalPhi]", "."], "Cr"]}], "]"}]}], ",", 
     SubscriptBox[
      OverscriptBox["\[CapitalPhi]", "."], "Cr"]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.942305597868095*^9, 3.9423057245514297`*^9}, {
   3.9423058531384687`*^9, 3.9423058553877907`*^9}, {3.942305911074548*^9, 
   3.942305931298141*^9}, {3.9423059707148247`*^9, 3.942305975613316*^9}, {
   3.9423060687269583`*^9, 3.942306081577973*^9}, {3.942306191270369*^9, 
   3.9423062369590263`*^9}, {3.942306267050644*^9, 3.942306295195217*^9}, {
   3.9423063648133163`*^9, 3.9423063695419493`*^9}, 3.9423064883190727`*^9, {
   3.942306561535211*^9, 3.942306616221942*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"b54ad65b-a370-4e10-9a68-bd30be080c78"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hamiltonian", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["Q", "p"], "*", 
     SubscriptBox[
      OverscriptBox["\[CapitalPhi]", "."], "Cq"]}], " ", "+", 
    RowBox[{
     SubscriptBox["Q", "r"], "*", 
     SubscriptBox[
      OverscriptBox["\[CapitalPhi]", "."], "Cr"]}], "-", " ", 
    "NewLagrangian"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"qp1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"qr1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.942306108131072*^9, 3.942306116290464*^9}, {
  3.942306312026622*^9, 3.942306343275564*^9}, {3.942306452237636*^9, 
  3.942306554844182*^9}, {3.9423066011958637`*^9, 3.9423066208311453`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"c2dfb085-1e28-433d-a91b-4a989ad6554b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "EJ"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]", " ", 
      SubscriptBox["\[CapitalPhi]", "Cq"]}], 
     SubscriptBox["\[CapitalPhi]", "0"]], "]"}]}], "+", 
  FractionBox[
   SubsuperscriptBox["Q", "p", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["C", "q"]}]], "+", 
  FractionBox[
   SubsuperscriptBox["Q", "r", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["C", "r"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cr"]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "q"], " ", 
     SubscriptBox["L", "r"]}], "+", 
    RowBox[{
     SubscriptBox["L", "c"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       SubscriptBox["L", "r"]}], ")"}]}]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cq"], "-", 
      SubscriptBox["\[CapitalPhi]", "ext"]}], ")"}], "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["L", "q"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "r"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "r"]}]]}], ")"}]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cr"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["\[CapitalPhi]", "ext"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}]]}], ")"}], "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "q"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}]], "+", 
      SubscriptBox["L", "r"]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.942306473772626*^9, 3.942306501055303*^9}, {
   3.942306531828504*^9, 3.942306555608035*^9}, 3.942306621945099*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"4f200e24-6f58-47d1-9e79-ced576c9379e"]
}, Open  ]],

Cell[TextData[{
 "Expanding the external flux ",
 Cell[BoxData[
  SubscriptBox["\[CapitalPhi]", "ext"]],
  CellChangeTimes->{{3.9423066923948927`*^9, 3.942306700024844*^9}, {
    3.942306882942829*^9, 3.9423069107068872`*^9}, 3.9423070164127903`*^9, {
    3.942308857651392*^9, 3.9423089118570957`*^9}, {3.94230903822368*^9, 
    3.9423090924866962`*^9}},ExpressionUUID->
  "eadeb065-7b0a-4141-b074-6e38081e5bb6"],
 " in a time-independent term ",
 Cell[BoxData[
  SubscriptBox["\[CapitalPhi]", "ext0"]],
  CellChangeTimes->{{3.9423066923948927`*^9, 3.942306700024844*^9}, {
    3.942306882942829*^9, 3.9423069107068872`*^9}, 3.9423070164127903`*^9, {
    3.942308857651392*^9, 3.9423089118570957`*^9}, {3.94230903822368*^9, 
    3.9423090924866962`*^9}},ExpressionUUID->
  "20867f26-ec61-4f6e-8615-bd10e98eaf11"],
 " and a time-dependent term ",
 Cell[BoxData[
  SubscriptBox["\[CapitalPhi]", "ext1"]],
  CellChangeTimes->{{3.9423066923948927`*^9, 3.942306700024844*^9}, {
    3.942306882942829*^9, 3.9423069107068872`*^9}, 3.9423070164127903`*^9, {
    3.942308857651392*^9, 3.9423089118570957`*^9}, {3.94230903822368*^9, 
    3.9423090924866962`*^9}},ExpressionUUID->
  "f6cda370-f205-4a31-b4ad-5ea515666048"],
 ":"
}], "Text",
 CellChangeTimes->{{3.94230955313912*^9, 
  3.942309591218371*^9}},ExpressionUUID->"03775878-9f32-40a6-9e03-\
0ad96e9ed405"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpandedHamiltonian", " ", "=", " ", 
  RowBox[{"Hamiltonian", "/.", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[CapitalPhi]", "ext"], "->", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "ext0"], "+", 
      SubscriptBox["\[CapitalPhi]", "ext1"]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.9423066923948927`*^9, 3.942306700024844*^9}, {
   3.942306882942829*^9, 3.9423069107068872`*^9}, 3.9423070164127903`*^9, {
   3.942308857651392*^9, 3.9423089118570957`*^9}, {3.94230903822368*^9, 
   3.9423090924866962`*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"6d240017-fd4a-4b48-bb08-0f7fa348a696"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "EJ"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]", " ", 
      SubscriptBox["\[CapitalPhi]", "Cq"]}], 
     SubscriptBox["\[CapitalPhi]", "0"]], "]"}]}], "+", 
  FractionBox[
   SubsuperscriptBox["Q", "p", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["C", "q"]}]], "+", 
  FractionBox[
   SubsuperscriptBox["Q", "r", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["C", "r"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cr"]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "q"], " ", 
     SubscriptBox["L", "r"]}], "+", 
    RowBox[{
     SubscriptBox["L", "c"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       SubscriptBox["L", "r"]}], ")"}]}]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cq"], "-", 
      SubscriptBox["\[CapitalPhi]", "ext0"], "-", 
      SubscriptBox["\[CapitalPhi]", "ext1"]}], ")"}], "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["L", "q"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "r"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "r"]}]]}], ")"}]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cr"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[CapitalPhi]", "ext0"], "+", 
          SubscriptBox["\[CapitalPhi]", "ext1"]}], ")"}]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}]]}], ")"}], "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "q"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}]], "+", 
      SubscriptBox["L", "r"]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.9423088948683157`*^9, 3.9423089137094183`*^9}, {
  3.942309050964034*^9, 3.942309092921172*^9}},
 CellLabel->
  "Out[144]=",ExpressionUUID->"a3b975d3-f12a-4908-b15a-e7b2cf16c8e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HamiltonianZero", "=", " ", 
  RowBox[{"ExpandedHamiltonian", "/.", 
   RowBox[{
    SubscriptBox["\[CapitalPhi]", "ext1"], "->", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.9423069187337627`*^9, 3.942306926496117*^9}, {
  3.942306981493753*^9, 3.942307006631371*^9}, {3.942308881321097*^9, 
  3.942308881454514*^9}, {3.9423091048223133`*^9, 3.9423091174211807`*^9}, {
  3.942309180818123*^9, 3.942309187573841*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"4e26b09c-8abb-47fa-838e-6a0a80284cdf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "EJ"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]", " ", 
      SubscriptBox["\[CapitalPhi]", "Cq"]}], 
     SubscriptBox["\[CapitalPhi]", "0"]], "]"}]}], "+", 
  FractionBox[
   SubsuperscriptBox["Q", "p", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["C", "q"]}]], "+", 
  FractionBox[
   SubsuperscriptBox["Q", "r", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["C", "r"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cr"]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "q"], " ", 
     SubscriptBox["L", "r"]}], "+", 
    RowBox[{
     SubscriptBox["L", "c"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       SubscriptBox["L", "r"]}], ")"}]}]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cq"], "-", 
      SubscriptBox["\[CapitalPhi]", "ext0"]}], ")"}], "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["L", "q"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "r"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "r"]}]]}], ")"}]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cr"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["\[CapitalPhi]", "ext0"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}]]}], ")"}], "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "q"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}]], "+", 
      SubscriptBox["L", "r"]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.942306927133978*^9, {3.9423069837954617`*^9, 3.942307018738792*^9}, 
   3.94230888189534*^9, 3.942308916657556*^9, 3.942309117883602*^9, {
   3.942309181253202*^9, 3.9423091879209547`*^9}},
 CellLabel->
  "Out[149]=",ExpressionUUID->"c31f8eae-e497-4119-be09-17c9b015d9e8"]
}, Open  ]],

Cell["So the displacement terms of the Hamiltonian are:", "Text",
 CellChangeTimes->{{3.942309340829707*^9, 
  3.94230934697309*^9}},ExpressionUUID->"c9e7540c-0a74-46d5-94f7-\
dabe5a3527b6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HamiltonianOne", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ExpandedHamiltonian", "-", "HamiltonianZero"}], "//", 
     "Expand"}], ")"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[CapitalPhi]", "ext1", "2"], "->", "0"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[CapitalPhi]", "ext0"], " ", 
       SubscriptBox["\[CapitalPhi]", "ext1"]}], "->", "0"}]}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.942309147363285*^9, 3.942309160533884*^9}, 
   3.942309195521681*^9, {3.942309230020746*^9, 3.942309330291888*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"0d70ef36-1c34-4909-8923-b470ecc11215"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
     SubscriptBox["\[CapitalPhi]", "ext1"]}], 
    RowBox[{
     SubscriptBox["L", "q"], "+", 
     FractionBox[
      RowBox[{
       SubscriptBox["L", "c"], " ", 
       SubscriptBox["L", "r"]}], 
      RowBox[{
       SubscriptBox["L", "c"], "+", 
       SubscriptBox["L", "r"]}]]}]]}], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cr"], " ", 
    SubscriptBox["\[CapitalPhi]", "ext1"]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["L", "c"], "+", 
      SubscriptBox["L", "q"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "q"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}]], "+", 
      SubscriptBox["L", "r"]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.942309149427101*^9, 3.942309160832786*^9}, 
   3.942309196321257*^9, {3.942309231595662*^9, 3.9423093305452223`*^9}},
 CellLabel->
  "Out[162]=",ExpressionUUID->"9e5715c9-188b-41d9-ab33-d3946221cd67"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "This part is experimental, it\[CloseCurlyQuote]s easier to remove the \
displacement term of the resonator when ",
 Cell[BoxData[
  SubscriptBox["\[CapitalPhi]", "ext"]],
  CellChangeTimes->{{3.9423105116987133`*^9, 3.9423105925148563`*^9}, {
   3.942310627722212*^9, 3.9423106684809437`*^9}},ExpressionUUID->
  "b69ca0fe-31b2-4f9e-9220-6ecf8ea01698"],
 " is time-independent, but when you include the dependence, then you have \
the term ",
 Cell[BoxData[
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["Q", "rt"], " ", 
    SubscriptBox[
     OverscriptBox["\[CapitalPhi]", "."], "ext"]}], 
   RowBox[{
    SubscriptBox["L", "c"], "+", 
    SubscriptBox["L", "q"]}]]],
  CellChangeTimes->{{3.942311296496414*^9, 3.942311360113131*^9}},
  ExpressionUUID->"15c024ba-e5c6-4377-8fe4-2eea06abf466"],
 " so we don\[CloseCurlyQuote]t gain much. That\[CloseCurlyQuote]s why I \
think we maybe should keep the displacement term in the resonator."
}], "Subsubsection",
 CellChangeTimes->{{3.942311741400412*^9, 
  3.9423118229683228`*^9}},ExpressionUUID->"3a9b9c3c-d8e4-47cb-b9d7-\
2b6524daa5bd"],

Cell["\<\
Let\[CloseCurlyQuote]s start by treating the time-independent term of the \
Hamiltonian and doing a change of variable to eliminate the displacement in \
the resonator. For this purpose, let\[CloseCurlyQuote]s return to the \
Lagrangian:\
\>", "Text",
 CellChangeTimes->{{3.942309996867991*^9, 3.942310021910955*^9}, {
  3.942310078571683*^9, 
  3.942310090227222*^9}},ExpressionUUID->"1641aaa4-de74-4c10-baf5-\
7baba40fc08b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NewLagrangian", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[CapitalPhi]", "Cr"], "->", 
          RowBox[{
           SubscriptBox["\[CapitalPhi]", "Cr1"], "-", 
           FractionBox[
            RowBox[{
             SubscriptBox["L", "c"], " ", 
             SubscriptBox["\[CapitalPhi]", "ext"]}], 
            RowBox[{
             SubscriptBox["L", "c"], "+", 
             SubscriptBox["L", "q"]}]]}]}], ",", " ", 
         RowBox[{
          SubscriptBox[
           OverscriptBox["\[CapitalPhi]", "."], "Cr"], "->", 
          RowBox[{
           SubscriptBox[
            OverscriptBox["\[CapitalPhi]", "."], "Cr1"], "-", 
           FractionBox[
            RowBox[{
             SubscriptBox["L", "c"], " ", 
             SubscriptBox[
              OverscriptBox["\[CapitalPhi]", "."], "ext"]}], 
            RowBox[{
             SubscriptBox["L", "c"], "+", 
             SubscriptBox["L", "q"]}]]}]}]}], "}"}]}], "//", "Expand"}], ",", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubsuperscriptBox["\[CapitalPhi]", "ext", "2"], "->", "0"}], ",", " ", 
       RowBox[{
        SubsuperscriptBox[
         OverscriptBox["\[CapitalPhi]", "."], "ext", "2"], "->", "0"}]}], 
      "}"}]}], "]"}], ",", 
   RowBox[{
    SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
    SubscriptBox["\[CapitalPhi]", "ext"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9423105116987133`*^9, 3.9423105925148563`*^9}, {
  3.942310627722212*^9, 3.9423106684809437`*^9}},
 CellLabel->
  "In[203]:=",ExpressionUUID->"dc3d1296-cff2-455f-9e10-68b3016ab83e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EJ", " ", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]", " ", 
      SubscriptBox["\[CapitalPhi]", "Cq"]}], 
     SubscriptBox["\[CapitalPhi]", "0"]], "]"}]}], "-", 
  FractionBox[
   SubsuperscriptBox["\[CapitalPhi]", "Cq", "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["L", "q"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "r"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "r"]}]]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cr1"]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "q"], " ", 
     SubscriptBox["L", "r"]}], "+", 
    RowBox[{
     SubscriptBox["L", "c"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       SubscriptBox["L", "r"]}], ")"}]}]}]], "-", 
  FractionBox[
   SubsuperscriptBox["\[CapitalPhi]", "Cr1", "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "q"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}]], "+", 
      SubscriptBox["L", "r"]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox["L", "c"], " ", 
         SubscriptBox["L", "r"]}], 
        RowBox[{
         SubscriptBox["L", "c"], "+", 
         SubscriptBox["L", "r"]}]]}]], "-", 
     FractionBox[
      SubsuperscriptBox["L", "c", "2"], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "c"], "+", 
         SubscriptBox["L", "q"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["L", "q"], " ", 
          SubscriptBox["L", "r"]}], "+", 
         RowBox[{
          SubscriptBox["L", "c"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["L", "q"], "+", 
            SubscriptBox["L", "r"]}], ")"}]}]}], ")"}]}]]}], ")"}], " ", 
   SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
   SubscriptBox["\[CapitalPhi]", "ext"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SubscriptBox["C", "q"], " ", 
   SubsuperscriptBox[
    OverscriptBox["\[CapitalPhi]", "."], "Cq", "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SubscriptBox["C", "r"], " ", 
   SubsuperscriptBox[
    OverscriptBox["\[CapitalPhi]", "."], "Cr1", "2"]}], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["C", "r"], " ", 
    SubscriptBox["L", "c"], " ", 
    SubscriptBox[
     OverscriptBox["\[CapitalPhi]", "."], "Cr1"], " ", 
    SubscriptBox[
     OverscriptBox["\[CapitalPhi]", "."], "ext"]}], 
   RowBox[{
    SubscriptBox["L", "c"], "+", 
    SubscriptBox["L", "q"]}]]}]], "Output",
 CellChangeTimes->{{3.942310506033566*^9, 3.942310592850318*^9}, 
   3.9423106369440813`*^9, 3.942310686591964*^9},
 CellLabel->
  "Out[203]=",ExpressionUUID->"ac0d3e77-6678-4b3f-9cb6-cf087141edc9"]
}, Open  ]],

Cell["So now, let\[CloseCurlyQuote]s form the binomio again:", "Text",
 CellChangeTimes->{{3.942310339877516*^9, 
  3.94231034511839*^9}},ExpressionUUID->"5160961d-45f8-419d-80a9-\
bf76c7d5f9ef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        SubscriptBox["L", "q"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["L", "c"], " ", 
          SubscriptBox["L", "r"]}], 
         RowBox[{
          SubscriptBox["L", "c"], "+", 
          SubscriptBox["L", "r"]}]]}]], "-", 
      FractionBox[
       SubsuperscriptBox["L", "c", "2"], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["L", "c"], "+", 
          SubscriptBox["L", "q"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["L", "q"], " ", 
           SubscriptBox["L", "r"]}], "+", 
          RowBox[{
           SubscriptBox["L", "c"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["L", "q"], "+", 
             SubscriptBox["L", "r"]}], ")"}]}]}], ")"}]}]]}], ")"}], "/", 
    FractionBox["1", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["L", "q"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["L", "c"], " ", 
          SubscriptBox["L", "r"]}], 
         RowBox[{
          SubscriptBox["L", "c"], "+", 
          SubscriptBox["L", "r"]}]]}], ")"}]}]]}], "/", "2"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.9423103551484623`*^9, 3.942310379687645*^9}, 
   3.9423107203863153`*^9},
 CellLabel->
  "In[204]:=",ExpressionUUID->"4d775915-41cd-47b5-8c28-f9baf0dab636"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   SubsuperscriptBox["L", "c", "2"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["L", "c"], "+", 
      SubscriptBox["L", "q"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["L", "c"], "+", 
      SubscriptBox["L", "r"]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.942310375537898*^9, 3.9423103798450203`*^9}, 
   3.942310720835339*^9},
 CellLabel->
  "Out[204]=",ExpressionUUID->"ac7da65b-3a73-499a-9370-ea09181c9baa"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewLagrangianTimeDependent", "=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["C", "q"], " ", 
     SubsuperscriptBox[
      OverscriptBox["\[CapitalPhi]", "."], "Cq", "2"]}], "-", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "q"], "+", 
         FractionBox[
          RowBox[{
           SubscriptBox["L", "c"], " ", 
           SubscriptBox["L", "r"]}], 
          RowBox[{
           SubscriptBox["L", "c"], "+", 
           SubscriptBox["L", "r"]}]]}], ")"}]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[CapitalPhi]", "Cq"], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubsuperscriptBox["L", "c", "2"], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["L", "c"], "+", 
               SubscriptBox["L", "q"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["L", "c"], "+", 
               SubscriptBox["L", "r"]}], ")"}]}]]}], ")"}], 
         SubscriptBox["\[CapitalPhi]", "ext"]}]}], ")"}], "2"]}], "+", 
    RowBox[{"EJ", " ", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]", " ", 
        SubscriptBox["\[CapitalPhi]", "Cq"]}], 
       SubscriptBox["\[CapitalPhi]", "0"]], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["C", "r"], " ", 
     SubsuperscriptBox[
      OverscriptBox["\[CapitalPhi]", "."], "Cr1", "2"]}], "-", 
    FractionBox[
     SubsuperscriptBox["\[CapitalPhi]", "Cr1", "2"], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          SubscriptBox["L", "c"], " ", 
          SubscriptBox["L", "q"]}], 
         RowBox[{
          SubscriptBox["L", "c"], "+", 
          SubscriptBox["L", "q"]}]], "+", 
        SubscriptBox["L", "r"]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["L", "c"], " ", 
      SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
      SubscriptBox["\[CapitalPhi]", "Cr1"]}], 
     RowBox[{
      RowBox[{
       SubscriptBox["L", "q"], " ", 
       SubscriptBox["L", "r"]}], "+", 
      RowBox[{
       SubscriptBox["L", "c"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "q"], "+", 
         SubscriptBox["L", "r"]}], ")"}]}]}]], "-", 
    FractionBox[
     RowBox[{
      SubscriptBox["C", "r"], " ", 
      SubscriptBox["L", "c"], " ", 
      SubscriptBox[
       OverscriptBox["\[CapitalPhi]", "."], "Cr1"], " ", 
      SubscriptBox[
       OverscriptBox["\[CapitalPhi]", "."], "ext"]}], 
     RowBox[{
      SubscriptBox["L", "c"], "+", 
      SubscriptBox["L", "q"]}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.942310740822955*^9, 3.9423108589377193`*^9}, {
  3.942310909566684*^9, 3.9423109143983192`*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"0cf8ba02-35e1-44a9-9276-ffada92d3b6f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"qp2", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["Q", "qt"], "==", 
      RowBox[{"D", "[", 
       RowBox[{"NewLagrangianTimeDependent", ",", 
        SubscriptBox[
         OverscriptBox["\[CapitalPhi]", "."], "Cq"]}], "]"}]}], ",", 
     SubscriptBox[
      OverscriptBox["\[CapitalPhi]", "."], "Cq"]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qr2", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["Q", "rt"], "==", 
      RowBox[{"D", "[", 
       RowBox[{"NewLagrangianTimeDependent", ",", 
        SubscriptBox[
         OverscriptBox["\[CapitalPhi]", "."], "Cr1"]}], "]"}]}], ",", 
     SubscriptBox[
      OverscriptBox["\[CapitalPhi]", "."], "Cr1"]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.9423109713593683`*^9, 3.942311019157401*^9}, {
  3.942316079239231*^9, 3.9423160793555717`*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"e741d7c7-11ef-4146-a3c7-4f4d325d4864"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HamiltonianTimeDependent", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["Q", "qt"], "*", 
       SubscriptBox[
        OverscriptBox["\[CapitalPhi]", "."], "Cq"]}], " ", "+", 
      RowBox[{
       SubscriptBox["Q", "rt"], "*", 
       SubscriptBox[
        OverscriptBox["\[CapitalPhi]", "."], "Cr1"]}], "-", " ", 
      "NewLagrangianTimeDependent"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"qp2", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"qr2", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubsuperscriptBox["Q", "qt", "2"], ",", 
      RowBox[{
       SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
       SubscriptBox["\[CapitalPhi]", "Cr1"]}], ",", 
      SubsuperscriptBox["\[CapitalPhi]", "Cr1", "2"], ",", 
      SubsuperscriptBox["Q", "rt", "2"], ",", 
      SubsuperscriptBox["\[CapitalPhi]", "Cr1", "2"]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.942310951252699*^9, 3.942310958054737*^9}, {
  3.942311007830552*^9, 3.94231104125669*^9}, {3.9423110860867167`*^9, 
  3.942311274081489*^9}, {3.9423160883586187`*^9, 3.9423160936965637`*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"4574fc88-16de-469a-b209-8bbccfad6057"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "EJ"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]", " ", 
      SubscriptBox["\[CapitalPhi]", "Cq"]}], 
     SubscriptBox["\[CapitalPhi]", "0"]], "]"}]}], "+", 
  FractionBox[
   SubsuperscriptBox["Q", "qt", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["C", "q"]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SubsuperscriptBox["L", "c", "2"], 
       RowBox[{"2", " ", 
        SubscriptBox["C", "r"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["L", "c"], "+", 
           SubscriptBox["L", "q"]}], ")"}], "2"]}]]}], "-", 
     FractionBox[
      RowBox[{
       SubscriptBox["L", "c"], " ", 
       SubscriptBox["L", "q"]}], 
      RowBox[{
       SubscriptBox["C", "r"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["L", "c"], "+", 
          SubscriptBox["L", "q"]}], ")"}], "2"]}]], "-", 
     FractionBox[
      SubsuperscriptBox["L", "q", "2"], 
      RowBox[{"2", " ", 
       SubscriptBox["C", "r"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["L", "c"], "+", 
          SubscriptBox["L", "q"]}], ")"}], "2"]}]], "+", 
     FractionBox[
      SubscriptBox["L", "c"], 
      RowBox[{
       SubscriptBox["C", "r"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "c"], "+", 
         SubscriptBox["L", "q"]}], ")"}]}]], "+", 
     FractionBox[
      SubscriptBox["L", "q"], 
      RowBox[{
       SubscriptBox["C", "r"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "c"], "+", 
         SubscriptBox["L", "q"]}], ")"}]}]]}], ")"}], " ", 
   SubsuperscriptBox["Q", "rt", "2"]}], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cr1"]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "q"], " ", 
     SubscriptBox["L", "r"]}], "+", 
    RowBox[{
     SubscriptBox["L", "c"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       SubscriptBox["L", "r"]}], ")"}]}]}]], "+", 
  FractionBox[
   SubsuperscriptBox["\[CapitalPhi]", "Cr1", "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "q"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}]], "+", 
      SubscriptBox["L", "r"]}], ")"}]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cq"], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          SubsuperscriptBox["L", "c", "2"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["L", "c"], "+", 
             SubscriptBox["L", "q"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["L", "c"], "+", 
             SubscriptBox["L", "r"]}], ")"}]}]]}], ")"}], " ", 
       SubscriptBox["\[CapitalPhi]", "ext"]}]}], ")"}], "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["L", "q"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "r"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "r"]}]]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["Q", "rt"], " ", 
    SubscriptBox[
     OverscriptBox["\[CapitalPhi]", "."], "ext"]}], 
   RowBox[{
    SubscriptBox["L", "c"], "+", 
    SubscriptBox["L", "q"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["C", "r"], " ", 
    SubsuperscriptBox["L", "c", "2"], " ", 
    SubsuperscriptBox[
     OverscriptBox["\[CapitalPhi]", "."], "ext", "2"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "c"], "+", 
       SubscriptBox["L", "q"]}], ")"}], "2"]}]]}]], "Output",
 CellChangeTimes->{{3.942311041426078*^9, 3.942311046290059*^9}, {
   3.942311099637657*^9, 3.942311160130147*^9}, 3.942311199431808*^9, {
   3.942311245609744*^9, 3.942311274320819*^9}, {3.942316089890156*^9, 
   3.942316095091056*^9}},
 CellLabel->
  "Out[260]=",ExpressionUUID->"7897996f-3a75-49e3-bdb0-102d8547940b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SubsuperscriptBox["L", "c", "2"], 
      RowBox[{"2", " ", 
       SubscriptBox["C", "r"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["L", "c"], "+", 
          SubscriptBox["L", "q"]}], ")"}], "2"]}]]}], "-", 
    FractionBox[
     RowBox[{
      SubscriptBox["L", "c"], " ", 
      SubscriptBox["L", "q"]}], 
     RowBox[{
      SubscriptBox["C", "r"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "c"], "+", 
         SubscriptBox["L", "q"]}], ")"}], "2"]}]], "-", 
    FractionBox[
     SubsuperscriptBox["L", "q", "2"], 
     RowBox[{"2", " ", 
      SubscriptBox["C", "r"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "c"], "+", 
         SubscriptBox["L", "q"]}], ")"}], "2"]}]], "+", 
    FractionBox[
     SubscriptBox["L", "c"], 
     RowBox[{
      SubscriptBox["C", "r"], " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}], ")"}]}]], "+", 
    FractionBox[
     SubscriptBox["L", "q"], 
     RowBox[{
      SubscriptBox["C", "r"], " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}], ")"}]}]]}], ")"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.942311280934057*^9, 3.942311282713373*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"82972d26-2978-48cd-b4dd-3ae03c049319"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"2", " ", 
   SubscriptBox["C", "r"]}]]], "Output",
 CellChangeTimes->{3.9423112829467*^9, 3.942316100762505*^9},
 CellLabel->
  "Out[261]=",ExpressionUUID->"de8aefe4-c57e-4da4-a11e-e5eead83d803"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"HamiltonianTimeDependent", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "EJ"}], " ", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]", " ", 
        SubscriptBox["\[CapitalPhi]", "Cq"]}], 
       SubscriptBox["\[CapitalPhi]", "0"]], "]"}]}], "+", 
    FractionBox[
     SubsuperscriptBox["Q", "qt", "2"], 
     RowBox[{"2", " ", 
      SubscriptBox["C", "q"]}]], "+", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", " ", 
       SubscriptBox["C", "r"]}]], " ", 
     SubsuperscriptBox["Q", "rt", "2"]}], "-", 
    FractionBox[
     RowBox[{
      SubscriptBox["L", "c"], " ", 
      SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
      SubscriptBox["\[CapitalPhi]", "Cr1"]}], 
     RowBox[{
      RowBox[{
       SubscriptBox["L", "q"], " ", 
       SubscriptBox["L", "r"]}], "+", 
      RowBox[{
       SubscriptBox["L", "c"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "q"], "+", 
         SubscriptBox["L", "r"]}], ")"}]}]}]], "+", 
    FractionBox[
     SubsuperscriptBox["\[CapitalPhi]", "Cr1", "2"], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          SubscriptBox["L", "c"], " ", 
          SubscriptBox["L", "q"]}], 
         RowBox[{
          SubscriptBox["L", "c"], "+", 
          SubscriptBox["L", "q"]}]], "+", 
        SubscriptBox["L", "r"]}], ")"}]}]], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[CapitalPhi]", "Cq"], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubsuperscriptBox["L", "c", "2"], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["L", "c"], "+", 
               SubscriptBox["L", "q"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["L", "c"], "+", 
               SubscriptBox["L", "r"]}], ")"}]}]]}], ")"}], " ", 
         SubscriptBox["\[CapitalPhi]", "ext"]}]}], ")"}], "2"], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["L", "q"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["L", "c"], " ", 
          SubscriptBox["L", "r"]}], 
         RowBox[{
          SubscriptBox["L", "c"], "+", 
          SubscriptBox["L", "r"]}]]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["L", "c"], " ", 
      SubscriptBox["Q", "rt"], " ", 
      SubscriptBox[
       OverscriptBox["\[CapitalPhi]", "."], "ext"]}], 
     RowBox[{
      SubscriptBox["L", "c"], "+", 
      SubscriptBox["L", "q"]}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.942311296496414*^9, 3.942311360113131*^9}, {
  3.942316103909205*^9, 3.942316104043051*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"5992612a-3276-4e00-9fd6-1779193b7680"],

Cell[TextData[{
 "So if we divide the external flux ",
 Cell[BoxData[
  SubscriptBox["\[CapitalPhi]", "ext"]],
  CellChangeTimes->{{3.9423066923948927`*^9, 3.942306700024844*^9}, {
    3.942306882942829*^9, 3.9423069107068872`*^9}, 3.9423070164127903`*^9, {
    3.942308857651392*^9, 3.9423089118570957`*^9}, {3.94230903822368*^9, 
    3.9423090924866962`*^9}},ExpressionUUID->
  "e47746e5-6a5c-467f-b66b-3c9baad21e00"],
 " in a time-independent term ",
 Cell[BoxData[
  SubscriptBox["\[CapitalPhi]", "ext0"]],
  CellChangeTimes->{{3.9423066923948927`*^9, 3.942306700024844*^9}, {
    3.942306882942829*^9, 3.9423069107068872`*^9}, 3.9423070164127903`*^9, {
    3.942308857651392*^9, 3.9423089118570957`*^9}, {3.94230903822368*^9, 
    3.9423090924866962`*^9}},ExpressionUUID->
  "e9078343-458f-402b-aaf7-6c80446c898e"],
 " and a time-dependent term ",
 Cell[BoxData[
  SubscriptBox["\[CapitalPhi]", "ext1"]],
  CellChangeTimes->{{3.9423066923948927`*^9, 3.942306700024844*^9}, {
    3.942306882942829*^9, 3.9423069107068872`*^9}, 3.9423070164127903`*^9, {
    3.942308857651392*^9, 3.9423089118570957`*^9}, {3.94230903822368*^9, 
    3.9423090924866962`*^9}},ExpressionUUID->
  "6fa87ef3-e28d-4c56-9867-a6f939bdaccd"],
 ":"
}], "Text",
 CellChangeTimes->{{3.942311363470438*^9, 
  3.942311388258231*^9}},ExpressionUUID->"b43afc6f-c186-4dd7-b612-\
fb8a477741fe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HamiltonianTimeDependentExpanded", "=", 
  RowBox[{"HamiltonianTimeDependent", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "ext"], "->", 
      RowBox[{
       SubscriptBox["\[CapitalPhi]", "ext0"], "+", 
       SubscriptBox["\[CapitalPhi]", "ext1"]}]}], ",", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["\[CapitalPhi]", "."], "ext"], "->", 
      SubscriptBox[
       OverscriptBox["\[CapitalPhi]", "."], "ext1"]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.9423114000492287`*^9, 3.942311552086009*^9}, {
  3.942312826931209*^9, 3.942312836812896*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"065a0a27-560e-457e-8c8f-2bb1780afccc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "EJ"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]", " ", 
      SubscriptBox["\[CapitalPhi]", "Cq"]}], 
     SubscriptBox["\[CapitalPhi]", "0"]], "]"}]}], "+", 
  FractionBox[
   SubsuperscriptBox["Q", "qt", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["C", "q"]}]], "+", 
  FractionBox[
   SubsuperscriptBox["Q", "rt", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["C", "r"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cr1"]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "q"], " ", 
     SubscriptBox["L", "r"]}], "+", 
    RowBox[{
     SubscriptBox["L", "c"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       SubscriptBox["L", "r"]}], ")"}]}]}]], "+", 
  FractionBox[
   SubsuperscriptBox["\[CapitalPhi]", "Cr1", "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "q"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}]], "+", 
      SubscriptBox["L", "r"]}], ")"}]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cq"], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          SubsuperscriptBox["L", "c", "2"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["L", "c"], "+", 
             SubscriptBox["L", "q"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["L", "c"], "+", 
             SubscriptBox["L", "r"]}], ")"}]}]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[CapitalPhi]", "ext0"], "+", 
         SubscriptBox["\[CapitalPhi]", "ext1"]}], ")"}]}]}], ")"}], "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["L", "q"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "r"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "r"]}]]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["Q", "rt"], " ", 
    SubscriptBox[
     OverscriptBox["\[CapitalPhi]", "."], "ext1"]}], 
   RowBox[{
    SubscriptBox["L", "c"], "+", 
    SubscriptBox["L", "q"]}]]}]], "Output",
 CellChangeTimes->{{3.94231149054562*^9, 3.942311552377643*^9}, {
   3.9423128279489803`*^9, 3.942312837231365*^9}, 3.942316110616407*^9},
 CellLabel->
  "Out[263]=",ExpressionUUID->"7bfa5fba-50f8-4ce6-b7e4-12defae2fba1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HamiltonianTimeDependentZero", "=", 
  RowBox[{"HamiltonianTimeDependent", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "ext"], "->", 
      SubscriptBox["\[CapitalPhi]", "ext0"]}], ",", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["\[CapitalPhi]", "."], "ext"], "->", "0"}]}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.942311606739183*^9, 3.9423116464962*^9}, {
   3.9423116766950407`*^9, 3.942311679198464*^9}, 3.942311725948922*^9, {
   3.942312807319358*^9, 3.942312808808906*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"930108b3-6761-4e09-87b0-5fdca3a9dd70"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "EJ"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]", " ", 
      SubscriptBox["\[CapitalPhi]", "Cq"]}], 
     SubscriptBox["\[CapitalPhi]", "0"]], "]"}]}], "+", 
  FractionBox[
   SubsuperscriptBox["Q", "qt", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["C", "q"]}]], "+", 
  FractionBox[
   SubsuperscriptBox["Q", "rt", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["C", "r"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cr1"]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "q"], " ", 
     SubscriptBox["L", "r"]}], "+", 
    RowBox[{
     SubscriptBox["L", "c"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       SubscriptBox["L", "r"]}], ")"}]}]}]], "+", 
  FractionBox[
   SubsuperscriptBox["\[CapitalPhi]", "Cr1", "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "q"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}]], "+", 
      SubscriptBox["L", "r"]}], ")"}]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cq"], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          SubsuperscriptBox["L", "c", "2"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["L", "c"], "+", 
             SubscriptBox["L", "q"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["L", "c"], "+", 
             SubscriptBox["L", "r"]}], ")"}]}]]}], ")"}], " ", 
       SubscriptBox["\[CapitalPhi]", "ext0"]}]}], ")"}], "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["L", "q"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "r"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "r"]}]]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.9423116471968403`*^9, {3.942311709546781*^9, 3.9423117262612753`*^9}, 
   3.942312809369894*^9, 3.9423161131104116`*^9},
 CellLabel->
  "Out[264]=",ExpressionUUID->"1eb71a07-80f8-4c2b-b2b4-9298ee92c538"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
      "HamiltonianTimeDependentExpanded", "-", 
       "HamiltonianTimeDependentZero"}], "//", "Expand"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalPhi]", "ext0"], " ", 
         SubscriptBox["\[CapitalPhi]", "ext1"]}], "->", "0"}], ",", 
       RowBox[{
        SubsuperscriptBox["\[CapitalPhi]", "ext1", "2"], "->", "0"}]}], " ", 
      "}"}]}], "]"}], ",", 
   RowBox[{
    SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
    SubscriptBox["\[CapitalPhi]", "ext1"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.942312649867347*^9, 3.942312742752049*^9}, {
  3.942312846415482*^9, 3.942312850331489*^9}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"02ce9ff5-d11c-4a37-bb34-5e658cc1ab30"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        SubscriptBox["L", "q"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["L", "c"], " ", 
          SubscriptBox["L", "r"]}], 
         RowBox[{
          SubscriptBox["L", "c"], "+", 
          SubscriptBox["L", "r"]}]]}]]}], "+", 
     FractionBox[
      SubsuperscriptBox["L", "c", "2"], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "c"], "+", 
         SubscriptBox["L", "q"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "c"], "+", 
         SubscriptBox["L", "r"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "q"], "+", 
         FractionBox[
          RowBox[{
           SubscriptBox["L", "c"], " ", 
           SubscriptBox["L", "r"]}], 
          RowBox[{
           SubscriptBox["L", "c"], "+", 
           SubscriptBox["L", "r"]}]]}], ")"}]}]]}], ")"}], " ", 
   SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
   SubscriptBox["\[CapitalPhi]", "ext1"]}], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["Q", "rt"], " ", 
    SubscriptBox[
     OverscriptBox["\[CapitalPhi]", "."], "ext1"]}], 
   RowBox[{
    SubscriptBox["L", "c"], "+", 
    SubscriptBox["L", "q"]}]]}]], "Output",
 CellChangeTimes->{{3.9423126520595217`*^9, 3.942312743104619*^9}, 
   3.942312851808113*^9, 3.942316119782379*^9},
 CellLabel->
  "Out[265]=",ExpressionUUID->"97ea9df8-5b40-4203-a40e-78b7f6337a7e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox["L", "c"], " ", 
         SubscriptBox["L", "r"]}], 
        RowBox[{
         SubscriptBox["L", "c"], "+", 
         SubscriptBox["L", "r"]}]]}]]}], "+", 
    FractionBox[
     SubsuperscriptBox["L", "c", "2"], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "r"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["L", "q"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["L", "c"], " ", 
          SubscriptBox["L", "r"]}], 
         RowBox[{
          SubscriptBox["L", "c"], "+", 
          SubscriptBox["L", "r"]}]]}], ")"}]}]]}], ")"}], " ", "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.942312752199212*^9, 3.9423127537780952`*^9}},
 CellLabel->
  "In[250]:=",ExpressionUUID->"291d21a1-2410-4c70-956f-cf376950f8cd"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["1", 
   RowBox[{
    SubscriptBox["L", "c"], "+", 
    SubscriptBox["L", "q"]}]]}]], "Output",
 CellChangeTimes->{3.942312753963752*^9},
 CellLabel->
  "Out[250]=",ExpressionUUID->"8d2dd8fa-bbd7-4968-894f-cb7cbaf8b30b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"HamiltonianTimeDependentOne", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}]]}], 
     SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
     SubscriptBox["\[CapitalPhi]", "ext1"]}], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["L", "c"], " ", 
      SubscriptBox["Q", "rt"], " ", 
      SubscriptBox[
       OverscriptBox["\[CapitalPhi]", "."], "ext1"]}], 
     RowBox[{
      SubscriptBox["L", "c"], "+", 
      SubscriptBox["L", "q"]}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.942312765533914*^9, 3.9423127857265043`*^9}, {
  3.942312883923007*^9, 3.942312885008418*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"5b6ea065-dd4e-4808-aa16-1c105594b887"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s start by solving the HamiltonianTimeDependentZero in \
the case we consider ",
 Cell[BoxData[
  SubscriptBox["\[CapitalPhi]", "ext"]],
  CellChangeTimes->{{3.9423114000492287`*^9, 3.942311552086009*^9}, {
   3.942312826931209*^9, 3.942312836812896*^9}},ExpressionUUID->
  "d6028ac1-9549-464e-8ffb-27ae1f528bd5"],
 " as time-independent:"
}], "Text",
 CellChangeTimes->{{3.942313584723405*^9, 3.942313588794835*^9}, {
  3.942316027570414*^9, 
  3.94231605474446*^9}},ExpressionUUID->"7effca62-31a3-4bb3-acdd-\
a48a8c0db67d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     SubsuperscriptBox["Q", "qt", "2"], 
     RowBox[{"2", " ", 
      SubscriptBox["C", "q"]}]], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[CapitalPhi]", "Cq"], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubsuperscriptBox["L", "c", "2"], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["L", "c"], "+", 
               SubscriptBox["L", "q"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["L", "c"], "+", 
               SubscriptBox["L", "r"]}], ")"}]}]]}], ")"}], " ", 
         SubscriptBox["\[CapitalPhi]", "ext0"]}]}], ")"}], "2"], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["L", "q"], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["L", "c"], " ", 
          SubscriptBox["L", "r"]}], 
         RowBox[{
          SubscriptBox["L", "c"], "+", 
          SubscriptBox["L", "r"]}]]}], ")"}]}]], "-", 
    RowBox[{"EJ", " ", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]", " ", 
        SubscriptBox["\[CapitalPhi]", "Cq"]}], 
       SubscriptBox["\[CapitalPhi]", "0"]], "]"}]}]}], ")"}], "+", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     SubsuperscriptBox["Q", "rt", "2"], 
     RowBox[{"2", " ", 
      SubscriptBox["C", "r"]}]], "+", 
    FractionBox[
     SubsuperscriptBox["\[CapitalPhi]", "Cr1", "2"], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          SubscriptBox["L", "c"], " ", 
          SubscriptBox["L", "q"]}], 
         RowBox[{
          SubscriptBox["L", "c"], "+", 
          SubscriptBox["L", "q"]}]], "+", 
        SubscriptBox["L", "r"]}], ")"}]}]]}], ")"}], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cr1"]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "q"], " ", 
     SubscriptBox["L", "r"]}], "+", 
    RowBox[{
     SubscriptBox["L", "c"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       SubscriptBox["L", "r"]}], ")"}]}]}]]}]], "Input",
 CellChangeTimes->{{3.942316132509035*^9, 3.94231617414823*^9}},
 CellLabel->
  "In[272]:=",ExpressionUUID->"d526f28d-4c1d-48aa-ba64-18bbebaa57e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "EJ"}], " ", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]", " ", 
      SubscriptBox["\[CapitalPhi]", "Cq"]}], 
     SubscriptBox["\[CapitalPhi]", "0"]], "]"}]}], "+", 
  FractionBox[
   SubsuperscriptBox["Q", "qt", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["C", "q"]}]], "+", 
  FractionBox[
   SubsuperscriptBox["Q", "rt", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["C", "r"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["L", "c"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cq"], " ", 
    SubscriptBox["\[CapitalPhi]", "Cr1"]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "q"], " ", 
     SubscriptBox["L", "r"]}], "+", 
    RowBox[{
     SubscriptBox["L", "c"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["L", "q"], "+", 
       SubscriptBox["L", "r"]}], ")"}]}]}]], "+", 
  FractionBox[
   SubsuperscriptBox["\[CapitalPhi]", "Cr1", "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "q"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "q"]}]], "+", 
      SubscriptBox["L", "r"]}], ")"}]}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalPhi]", "Cq"], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          SubsuperscriptBox["L", "c", "2"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["L", "c"], "+", 
             SubscriptBox["L", "q"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["L", "c"], "+", 
             SubscriptBox["L", "r"]}], ")"}]}]]}], ")"}], " ", 
       SubscriptBox["\[CapitalPhi]", "ext0"]}]}], ")"}], "2"], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["L", "q"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["L", "c"], " ", 
        SubscriptBox["L", "r"]}], 
       RowBox[{
        SubscriptBox["L", "c"], "+", 
        SubscriptBox["L", "r"]}]]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.942338086234034*^9},
 CellLabel->
  "Out[272]=",ExpressionUUID->"189d0763-5e29-4f3d-8e05-a74d07148e81"]
}, Open  ]],

Cell["Diagonalizing the system will give us:", "Text",
 CellChangeTimes->{{3.942332115073717*^9, 
  3.942332128321357*^9}},ExpressionUUID->"41f5d83c-2a38-4f69-bb6f-\
5f161cc01746"],

Cell[TextData[{
 "Now we can treat the problem assuming ",
 Cell[BoxData[
  SubscriptBox["\[CapitalPhi]", "ext1"]],
  CellChangeTimes->{{3.942309149427101*^9, 3.942309160832786*^9}, 
    3.942309196321257*^9, {3.942309231595662*^9, 3.9423093305452223`*^9}},
  ExpressionUUID->"097b21e5-5597-47e5-bddb-d035173d4faf"],
 " is periodic."
}], "Text",
 CellChangeTimes->{{3.942309681832122*^9, 
  3.942309699101149*^9}},ExpressionUUID->"46697b0f-d6a1-4959-bcc7-\
5573741f2ebb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9423381382713137`*^9, 
  3.942338144331562*^9}},ExpressionUUID->"c3c5559f-af85-4c89-8226-\
085d79441171"]
}, Open  ]]
},
WindowSize->{1512, 841},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
TaggingRules-><|
 "ChatNotebookSettings" -> <|
   "LLMEvaluator" -> "CodeAssistant", "Assistance" -> True|>|>,
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->"Chatbook.nb",
ExpressionUUID->"4c5cbdf2-eff1-4f26-a524-b6b5526d7ef5"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 760, 18, 42, "Input",ExpressionUUID->"aae5bc2f-b6b1-4cd3-b3a2-2da94e516a5a"],
Cell[1317, 40, 1150, 32, 47, "Input",ExpressionUUID->"55d23824-75d2-43ef-94bd-92d55565b59b"],
Cell[2470, 74, 288, 6, 29, "Input",ExpressionUUID->"8e60f00c-926f-4a49-8e4e-e3554e78a337"],
Cell[2761, 82, 184, 3, 33, "Text",ExpressionUUID->"298a73bc-5e75-44c1-9fea-fb93768a2a86"],
Cell[2948, 87, 1502, 34, 92, "Input",ExpressionUUID->"97ebba7c-fded-4ca8-8823-fa13e6885cb1"],
Cell[CellGroupData[{
Cell[4475, 125, 619, 12, 29, "Input",ExpressionUUID->"8aa8dbc7-7563-48e2-bb78-a0e6eca4bda4"],
Cell[5097, 139, 1135, 27, 34, "Output",ExpressionUUID->"e032ffcd-1b74-41cd-82a6-2e085ce1d429"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6269, 171, 347, 7, 29, "Input",ExpressionUUID->"6c0d5732-513e-48e1-90e7-61b6ea2c4ac4"],
Cell[6619, 180, 1477, 39, 54, "Output",ExpressionUUID->"7bf4aa8c-f5a6-4f7c-85e3-4d54e52ba4ac"]
}, Open  ]],
Cell[8111, 222, 744, 15, 34, "Text",ExpressionUUID->"afdcebd8-7ff4-4e18-b625-8a62b52a92f6"],
Cell[CellGroupData[{
Cell[8880, 241, 779, 16, 29, "Input",ExpressionUUID->"08bcf159-9c9a-435b-a9ec-5c71720a6924"],
Cell[9662, 259, 1392, 39, 50, "Output",ExpressionUUID->"a7ad6212-7778-461f-8146-3aa2549d9930"]
}, Open  ]],
Cell[11069, 301, 565, 11, 29, "Input",ExpressionUUID->"16f476cb-d765-431d-89ab-11db8d5c2a88"],
Cell[CellGroupData[{
Cell[11659, 316, 1870, 36, 31, "Input",ExpressionUUID->"7bce6afa-7f96-4ae5-8508-47546c1dd8b7"],
Cell[13532, 354, 3855, 109, 54, "Output",ExpressionUUID->"0fc27aeb-10f1-4ed1-8100-b6e688327472"]
}, Open  ]],
Cell[17402, 466, 1014, 23, 34, "Text",ExpressionUUID->"1774e2c0-7453-48e4-a193-e0186285ae43"],
Cell[CellGroupData[{
Cell[18441, 493, 2651, 75, 60, "Input",ExpressionUUID->"3f45b45f-daee-4339-b268-ef9dca8a42f4"],
Cell[21095, 570, 905, 26, 53, "Output",ExpressionUUID->"5527f0fe-eb07-478b-bcec-e96d09979643"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22037, 601, 973, 26, 46, "Input",ExpressionUUID->"b6f71678-df75-437f-b130-3c934dcb8e66"],
Cell[23013, 629, 496, 13, 48, "Output",ExpressionUUID->"f1c3ced8-f076-4169-9603-e86f48b40f49"]
}, Open  ]],
Cell[23524, 645, 1014, 23, 33, "Text",ExpressionUUID->"fbcc1ea3-a22d-4780-ac0a-54005326de73"],
Cell[24541, 670, 2185, 63, 47, "Input",ExpressionUUID->"8859ba4d-88ca-47c7-a071-5cf8048480a3"],
Cell[CellGroupData[{
Cell[26751, 737, 1204, 37, 47, "Input",ExpressionUUID->"dd11621b-99a7-4285-9ffd-446c967d2e32"],
Cell[27958, 776, 473, 10, 50, "Output",ExpressionUUID->"dd606af0-9b15-4b1d-a08e-45b0815f31d2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28468, 791, 923, 25, 47, "Input",ExpressionUUID->"c336ac93-ca00-41c8-962b-8e7d49cf0276"],
Cell[29394, 818, 475, 13, 50, "Output",ExpressionUUID->"dfea3f4c-7245-438a-9592-b5a25aa9a4ed"]
}, Open  ]],
Cell[29884, 834, 562, 17, 47, "Input",ExpressionUUID->"6d5befa7-1792-4328-91fc-91ed32f6b7cf"],
Cell[30449, 853, 1657, 43, 47, "Input",ExpressionUUID->"453e632f-d8db-4e9a-9c71-7dcb283a9825"],
Cell[CellGroupData[{
Cell[32131, 900, 322, 5, 29, "Input",ExpressionUUID->"31cad483-734f-4f9f-b5e7-572a52b695d1"],
Cell[32456, 907, 2410, 77, 80, "Output",ExpressionUUID->"a5e84a52-91d1-4c29-9f7d-2c5cbfc0023b"]
}, Open  ]],
Cell[34881, 987, 375, 6, 33, "Text",ExpressionUUID->"deb05919-6b90-4318-99d2-05300c703037"],
Cell[35259, 995, 1361, 34, 53, "Input",ExpressionUUID->"b54ad65b-a370-4e10-9a68-bd30be080c78"],
Cell[CellGroupData[{
Cell[36645, 1033, 892, 24, 29, "Input",ExpressionUUID->"c2dfb085-1e28-433d-a91b-4a989ad6554b"],
Cell[37540, 1059, 2240, 74, 80, "Output",ExpressionUUID->"4f200e24-6f58-47d1-9e79-ced576c9379e"]
}, Open  ]],
Cell[39795, 1136, 1355, 29, 33, "Text",ExpressionUUID->"03775878-9f32-40a6-9e03-0ad96e9ed405"],
Cell[CellGroupData[{
Cell[41175, 1169, 638, 14, 29, "Input",ExpressionUUID->"6d240017-fd4a-4b48-bb08-0f7fa348a696"],
Cell[41816, 1185, 2384, 79, 80, "Output",ExpressionUUID->"a3b975d3-f12a-4908-b15a-e7b2cf16c8e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44237, 1269, 522, 10, 29, "Input",ExpressionUUID->"4e26b09c-8abb-47fa-838e-6a0a80284cdf"],
Cell[44762, 1281, 2322, 77, 80, "Output",ExpressionUUID->"c31f8eae-e497-4119-be09-17c9b015d9e8"]
}, Open  ]],
Cell[47099, 1361, 190, 3, 33, "Text",ExpressionUUID->"c9e7540c-0a74-46d5-94f7-dabe5a3527b6"],
Cell[CellGroupData[{
Cell[47314, 1368, 696, 19, 31, "Input",ExpressionUUID->"0d70ef36-1c34-4909-8923-b470ecc11215"],
Cell[48013, 1389, 1204, 39, 63, "Output",ExpressionUUID->"9e5715c9-188b-41d9-ab33-d3946221cd67"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49254, 1433, 1137, 27, 76, "Subsubsection",ExpressionUUID->"3a9b9c3c-d8e4-47cb-b9d7-2b6524daa5bd"],
Cell[50394, 1462, 436, 9, 33, "Text",ExpressionUUID->"1641aaa4-de74-4c10-baf5-7baba40fc08b"],
Cell[CellGroupData[{
Cell[50855, 1475, 1730, 49, 49, "Input",ExpressionUUID->"dc3d1296-cff2-455f-9e10-68b3016ab83e"],
Cell[52588, 1526, 3217, 106, 72, "Output",ExpressionUUID->"ac0d3e77-6678-4b3f-9cb6-cf087141edc9"]
}, Open  ]],
Cell[55820, 1635, 195, 3, 33, "Text",ExpressionUUID->"5160961d-45f8-419d-80a9-bf76c7d5f9ef"],
Cell[CellGroupData[{
Cell[56040, 1642, 1522, 50, 66, "Input",ExpressionUUID->"4d775915-41cd-47b5-8c28-f9baf0dab636"],
Cell[57565, 1694, 511, 16, 52, "Output",ExpressionUUID->"ac7da65b-3a73-499a-9370-ea09181c9baa"]
}, Open  ]],
Cell[58091, 1713, 3066, 94, 63, "Input",ExpressionUUID->"0cf8ba02-35e1-44a9-9276-ffada92d3b6f"],
Cell[61160, 1809, 1016, 30, 53, "Input",ExpressionUUID->"e741d7c7-11ef-4146-a3c7-4f4d325d4864"],
Cell[CellGroupData[{
Cell[62201, 1843, 1389, 37, 31, "Input",ExpressionUUID->"4574fc88-16de-469a-b209-8bbccfad6057"],
Cell[63593, 1882, 4474, 148, 80, "Output",ExpressionUUID->"7897996f-3a75-49e3-bdb0-102d8547940b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68104, 2035, 1563, 53, 52, "Input",ExpressionUUID->"82972d26-2978-48cd-b4dd-3ae03c049319"],
Cell[69670, 2090, 239, 6, 48, "Output",ExpressionUUID->"de8aefe4-c57e-4da4-a11e-e5eead83d803"]
}, Open  ]],
Cell[69924, 2099, 2899, 90, 78, "Input",ExpressionUUID->"5992612a-3276-4e00-9fd6-1779193b7680"],
Cell[72826, 2191, 1362, 29, 33, "Text",ExpressionUUID->"b43afc6f-c186-4dd7-b612-fb8a477741fe"],
Cell[CellGroupData[{
Cell[74213, 2224, 718, 18, 31, "Input",ExpressionUUID->"065a0a27-560e-457e-8c8f-2bb1780afccc"],
Cell[74934, 2244, 2774, 91, 80, "Output",ExpressionUUID->"7bfa5fba-50f8-4ce6-b7e4-12defae2fba1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77745, 2340, 651, 16, 31, "Input",ExpressionUUID->"930108b3-6761-4e09-87b0-5fdca3a9dd70"],
Cell[78399, 2358, 2426, 80, 80, "Output",ExpressionUUID->"1eb71a07-80f8-4c2b-b2b4-9298ee92c538"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80862, 2443, 869, 24, 31, "Input",ExpressionUUID->"02ce9ff5-d11c-4a37-bb34-5e658cc1ab30"],
Cell[81734, 2469, 1582, 51, 69, "Output",ExpressionUUID->"97ea9df8-5b40-4203-a40e-78b7f6337a7e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83353, 2525, 1171, 39, 67, "Input",ExpressionUUID->"291d21a1-2410-4c70-956f-cf376950f8cd"],
Cell[84527, 2566, 263, 8, 50, "Output",ExpressionUUID->"8d2dd8fa-bbd7-4968-894f-cb7cbaf8b30b"]
}, Open  ]],
Cell[84805, 2577, 814, 24, 49, "Input",ExpressionUUID->"5b6ea065-dd4e-4808-aa16-1c105594b887"],
Cell[85622, 2603, 564, 13, 33, "Text",ExpressionUUID->"7effca62-31a3-4bb3-acdd-a48a8c0db67d"],
Cell[CellGroupData[{
Cell[86211, 2620, 2516, 81, 78, "Input",ExpressionUUID->"d526f28d-4c1d-48aa-ba64-18bbebaa57e7"],
Cell[88730, 2703, 2323, 78, 80, "Output",ExpressionUUID->"189d0763-5e29-4f3d-8e05-a74d07148e81"]
}, Open  ]],
Cell[91068, 2784, 180, 3, 33, "Text",ExpressionUUID->"41f5d83c-2a38-4f69-bb6f-5f161cc01746"],
Cell[91251, 2789, 471, 11, 33, "Text",ExpressionUUID->"46697b0f-d6a1-4959-bcc7-5573741f2ebb"],
Cell[91725, 2802, 154, 3, 29, "Input",ExpressionUUID->"c3c5559f-af85-4c89-8226-085d79441171"]
}, Open  ]]
}
]
*)

